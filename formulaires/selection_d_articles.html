<div class="formulaire_spip formulaire_selection_d_articles formulaire_selection_#ENV{id_selection}">

  [<div class="reponse_formulaire reponse_formulaire_erreur">
    (#ENV*{message_erreur})
  </div>]
  [<div class="reponse_formulaire reponse_formulaire_ok">
    (#ENV*{message_ok})
  </div>]

  <form action="#ENV{action}" method="post">
    #ACTION_FORMULAIRE{#ENV{action}}

    <ul>
      #GENERER_SAISIES{#ENV{_saisies}}
    </ul>

    #BOITE_OUVRIR{'','notice none-js'}
      Les données ont été modifiées, n'oubliez pas de cliquer sur "ok" pour confirmer les changements.
    #BOITE_FERMER

    <p class="boutons">
      <input type="submit" value="OK" />
    </p>
  </form>

  <script type="text/javascript">
   $(function () {
     /* On fait apparaître le message d'avertissement quand le
        formulaire a changé sans submit */
     $('.formulaire_selection_#ENV{id_selection}').change(function () {
       $(this).find('.notice').removeClass('none-js');
     });

     /* On masque le bouton "Ajouter" au début */
     var bouton_ajouter = $('.formulaire_selection_#ENV{id_selection}').find('.saisie_liste > fieldset > input[type="submit"]');
     bouton_ajouter.hide();

     /* Le dernier bouton modifier devient un "ajouter" */
     $('.formulaire_selection_#ENV{id_selection}').find('ul.saisie-liste > li').last().find('.picker_bouton a').text('Ajouter');
   });
  </script>
</div>
